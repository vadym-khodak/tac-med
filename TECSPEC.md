# Технічне Завдання (ТЗ) для створення програми перевірки знань з тактичної медицини

## Назва проєкту
**Програма для перевірки рівня знань теоретичних навичок тактичної медицини**

## Мета
Створити настільну програму з графічним інтерфейсом, яка дозволяє користувачам проходити тестування за протоколом MARCH, зберігати результати в локальній базі даних, визначати рівень знань та надавати адміністратору можливість керувати питаннями.

## 1. Загальні вимоги

| Параметр | Значення/Опис |
|----------|---------------|
| **Платформа** | Windows 7, 10, 11 |
| **Мова програмування** | TypeScript |
| **СУБД** | MongoDB |
| **Формати зображень** | JPG (розміщується по центру, адаптивний розмір) |

## 2. Режими роботи

### Користувач
- **Введення ПІБ** - ПІБ має складатися з трьох слів, кожне з яких починається з великої літери, містить лише кириличні символи та пробіли між словами. Довжина кожного слова має бути не менше 3 символів. При некоректному введенні виводиться підказка *"Введіть своє Прізвище Ім'я По-батькові через пробіл"* біля поля вводу та кнопка тестування залишається неактивною.
- **Проходження тесту**
- **Отримання результату**

### Адміністратор
- **Парольований доступ** з можливістю зміни
- **Можливість переглядати/експортувати статистику відповідей** (загальну та по кожному користувачу)
- **Можливість імпорту запитань та відповідей** на них за допомогою JSON

## 3. Користувацький інтерфейс

### 3.1. Головне меню
- **Кнопки**: Користувач, Адміністратор
- Якщо "Адміністратор" — запит паролю
- Якщо "Користувач" — форма введення Прізвище, Ім'я, По-батькові (обов'язкове поле, без заповнення не розпочинається тестування)

### 3.2. Тестування

Після того, як користувач коректно ввів свої ПІБ перед ним висвічується інформативне вікно в якому прописані загальні правила тестування та роз'яснення, як користуватись програмою в форматі:

> **Тестування Вашого рівня теоретичних знань по навичкам тактичної медицині**  
> буде включати в себе 6 блоків по 10 питань в кожному блоці.  
> Час на проходження тесту – **20 хвилин**.  
> Після закінчення часу тест буде завершено, правильні відповіді збережуться.
> 
> **Блоки питань:**
> 1. Загальні питання
> 2. Масивна кровотеча (Massive Hemorrhage)
> 3. Дихальні шляхи (Airway)
> 4. Дихання (Respiration)
> 5. Кровообіг (Circulation)
> 6. Гіпотермія/травма голови (Hypothermia/Head Injury)
> 
> Необхідно надати максимальну кількість правильних відповідей на всі поставлені запитання у визначений час.
> 
> В питаннях де правильних відповідей декілька – відповідь зараховується, якщо правильних відповідей більше половини (60%).

**Основні правила тестування:**

- Знизу інформативного вікна кнопка **"Розпочати тестування"**, після натискання якої висвітлюється перше питання та розпочинається відлік таймеру.
- Загальний зворотній таймер на 20 хвилин відображається зверху вікна тестування. 
- Після завершення часу – автоматичне завершення тесту зі збереженням результатів. 
- Якщо час закінчився, результат зберігається автоматично, навіть якщо користувач не встиг відповісти на всі питання. Незбережені питання вважаються як неправильні.
- Якщо програму закрито до завершення – результати не зберігаються. (При спробі закрити програму під час тестування користувачу виводиться попереджувальне вікно *'Тестування не завершено. Результати не будуть збережені. Ви впевнені, що хочете вийти?'* з кнопками "Так" та "Ні".)

**Структура тесту:**
- 6 блоків по 10 питань, які вибираються випадково з наявного переліку питань
- Кожне питання містить декілька відповідей (1 або кілька правильних).
- Якщо питанню відповідає одна правильна відповідь — використовуються радіокнопки.
- Якщо є декілька правильних відповідей — чекбокси.

**Система оцінювання:**
- За правильну відповідь нараховується 100%. Кожен правильний варіант ділить цю кількість порівну.
- Відповідь зараховується як правильна, якщо сума відсотків, отриманих за вибрані правильні варіанти, становить 60% або більше від загальної ваги питання (100%). Вибір неправильних варіантів не призводить до штрафних балів, але й не дає позитивного внеску в загальний відсоток за питання.

**Інтерфейс відповідей:**
- Після натискання кнопки **"Зберегти відповідь"** вибрані користувачем варіанти підсвічуються: 
  - якщо варіант є правильним та був обраний – зеленим
  - якщо варіант є неправильним та був обраний – червоним
  - невибрані правильні варіанти також підсвічуються зеленим
- Поки не обрано жодної відповіді — кнопка "Зберегти відповідь" неактивна. 
- Після збереження відповідей — активується кнопка "Наступне питання".
- Наступне питання з'являється тільки після натискання кнопки "Наступне питання".
- Кнопки в користувацькому інтерфейсі питань: **"Зберегти відповідь"** та **"Наступне питання"**.

## 4. Блоки тестування
1. **Блок 1.** Загальні питання
2. **Блок 2.** Масивна кровотеча (Massive Hemorrhage)
3. **Блок 3.** Дихальні шляхи (Airway)
4. **Блок 4.** Дихання (Respiration)
5. **Блок 5.** Кровообіг (Circulation)
6. **Блок 6.** Гіпотермія / травма голови (Hypothermia / Head Injury)

## 5. Підсумковий результат

Після повного проходження тесту (або якщо вийшов час по таймеру) користувачу висвітлюється інформативне вікно з:

### Таблиця результатів по блоках 
```
1. "Загальні питання" – 5 правильних відповідей з 10
2. "Масивна кровотеча" – 7 правильних відповідей з 10
3. ... 
```

### Загальна статистика
- **Загальна кількість правильних із 60 поставлених питань** (Загальна кількість правильних відповідей – 45 з 60)
- **Відсоток правильних відповідей** (Загальний відсоток правильних відповідей – 76%)
- **Рівень знань**: Низький або Початковий або Середній або Високий або Максимальний (Ваш рівень теоретичних знань з тактичної медицини – Високий)

### Рівень знань відповідно до відсотка правильних відповідей

| Відсоток | Рівень |
|----------|--------|
| 0–20% | Низький |
| 21–50% | Початковий |
| 51–80% | Середній |
| 81–95% | Високий |
| 96–100% | Максимальний |

Після завершення тестування (або якщо вийшов час по таймеру) результати тестування записуються в локальну базу даних.

Знизу інформативного вікна кнопка **"З результатами тестування ознайомлений"**.

Після натискання кнопки "З результатами тестування ознайомлений" повертається головне меню. 

## 6. Адміністратор

### Функціонал:
- **Вхід по паролю** (пароль за замовченням - 12345)
- **Можливість зміни пароля**
- **Перегляд усіх результатів** за весь час загальним списком по всім користувачам в форматі:

| Прізвище | Ім'я та По-батькові | Дата | Блок 1 | Блок 2 | Блок 3 | Блок 4 | Блок 5 | Блок 6 | Загальний результат |
|----------|---------------------|------|--------|--------|--------|--------|--------|--------|-------------------|
| Пупкін | Іван Іванович | 10.07.25 | 6 з 10 | 1 з 10 | 8 з 10 | 9 з 10 | 3 з 10 | 7 з 10 | 34 з 60 (56%) |
| | | 20.08.25 | 8 з 10 | 10 з 10 | 10 з 10 | 9 з 10 | 7 з 10 | 10 з 10 | 54 з 60 (90%) |
| Борисов | Євген Дмитрович | 11.07.25 | 6 з 10 | 1 з 10 | 8 з 10 | 9 з 10 | 3 з 10 | 7 з 10 | 34 з 60 (56%) |
| Колотний | Дмитро Борисович | 12.07.25 | 6 з 10 | 1 з 10 | 8 з 10 | 9 з 10 | 3 з 10 | 7 з 10 | 34 з 60 (56%) |

- **Можливість експорту результатів тестування у Excel** в такому ж форматі, як і перегляд бази даних з колонками: ПІБ, дата, поблокова кількість правильних відповідей, загальна кількість та відсоток правильних відповідей
- **Можливість завантаження запитань**, правильних відповідей та вказання конкретного блоку через кнопки "Імпорт" у форматі JSON
- Кнопка імпорту питань доступна лише в режимі адміністратора
- Імпорт питань перезаписує попередні питання у базі
- **Можливість перегляду питань та відповідей адміністратором в програмі** (Адміністратор має доступ до списку всіх питань в інтерфейсі програми. При виборі питання відображається його текст, варіанти відповідей з зазначенням правильних (наприклад, галочкою), а також прикріплені зображення або відео.)
- **Можливість додавання зображення до конкретного питання** (кнопка "Завантажити зображення")
  - Зображення розміщується зверху по центру. Під зображенням розміщується запитання та вибір відповідей.
- **Можливість додавання посилання з Youtube та відображення відео до конкретного запитання**
  - Відео розміщується зверху по центру. Під відео розміщується запитання та вибір відповідей.
  - Додавати можна АБО відео АБО зображення

### Обмеження:
- Адміністратор не може змінювати чи видаляти результати тестів
- Старий пароль має бути введений для зміни паролю

## 7. База даних

Програма зберігає всю інформацію в локальній базі MongoDB, яка складається з двох основних таблиць: **questions** (питання) та **results** (результати тестувань).

### 7.1 Таблиця questions — база тестових питань

| Назва поля | Тип | Пояснення |
|------------|-----|-----------|
| Id | INTEGER | Унікальний ідентифікатор (первинний ключ, автоінкремент) |
| Block | INTEGER | Номер навчального блоку (1–6) |
| Question | TEXT | Текст запитання |
| Answers | JSON | Масив з чотирьох відповідей. Наприклад: ["А", "Б", "В", "Г"] |
| Correct | JSON | Масив індексів правильних відповідей. Індексація з нуля ([0], [1,3]) |
| image_path | TEXT | Шлях до зображення (опційно). Наприклад: "images/img1.jpg" |
| youtube_url | TEXT | Посилання на YouTube-відео (опційно). Якщо задане — має пріоритет |

**Приклад запису в таблиці:**
```json
{
  "question": "Що таке кровотеча?",
  "answers": ["Підвищення температури", "Втрата крові", "Задишка", "Порушення свідомості"],
  "correct": [1],
  "block": 2,
  "image_path": "images/bleeding.jpg",
  "youtube_url": ""
}
```

**Пояснення:**
- Якщо correct = [1], то правильною вважається друга відповідь (answers[1]).
- Якщо вказані і зображення, і відео — програма показує відео.
- Правильні відповіді можуть бути однією ([2]) або кількома ([0,2]).

### 7.2 Таблиця results — історія результатів користувачів

| Назва поля | Тип | Пояснення |
|------------|-----|-----------|
| Id | INTEGER | Унікальний ідентифікатор (первинний ключ) |
| full_name | TEXT | ПІБ користувача (обов'язково кирилицею, без цифр). Очікується формат: три слова через пробіл. |
| test_date | DATETIME | Дата та час проходження тесту |
| block_scores | JSON | Відсотки правильних відповідей по кожному блоку. Приклад: {1:70, 2:100} |
| total_score | REAL | Загальний відсоток правильних відповідей (від 0 до 100, округлення до 2 знаків) |
| incorrect_list | JSON | Масив текстів запитань, на які були дані неправильні відповіді |

**Приклад:**
```json
{
  "full_name": "Колотний Дмитро Борисович",
  "test_date": "2025-07-25 10:30:00",
  "block_scores": {"1": 80, "2": 60, "3": 100, "4": 70, "5": 50, "6": 90},
  "total_score": 75.00,
  "incorrect_list": ["Яка перша дія при виявленні кровотечі?", "Як визначити наявність дихання?"]
}
```

### 7.3 Імпорт питань (JSON)
- Доступний лише в режимі адміністратора.
- Імпорт JSON-файлу перезаписує всі існуючі питання в базі. 
- Перед імпортом питань адміністратору виводиться попередження: *'Імпорт питань призведе до повного видалення всіх існуючих питань та їх заміни новими. Продовжити?'* з кнопками 'Так' та 'Ні'.

**Приклад JSON-файлу для імпорту:**
```json
[
  {
    "question": "Що таке кровотеча?",
    "answers": ["А", "Б", "В", "Г"],
    "correct": [1],
    "block": 1,
    "image_path": "",
    "youtube_url": ""
  },
  {
    "question": "Дії при пораненні?",
    "answers": ["Зупинити кровотечу", "Перевірити свідомість", "Зателефонувати другу", "Втекти"],
    "correct": [0, 1],
    "block": 1,
    "image_path": "",
    "youtube_url": "https://youtu.be/example"
  }
]
```

Програма орієнтується на індекси correct і автоматично зіставляє їх з відповідями в полі answers за позицією.

### 7.4 Валідація JSON
При імпорті питань програма повинна валідувати JSON-файл на відповідність структурі. У випадку помилок (наприклад, відсутність поля 'question', некоректний 'block') весь файл не імпортується, і користувачу відображається детальний лог помилок.

Перед збереженням питань у базу JSON-файл проходить перевірку на:
- наявність усіх обов'язкових полів (question, answers, correct, block);
- тип значень (наприклад, correct — список чисел, answers — список рядків);
- коректність блоків (від 1 до 6);
- відповідність індексів у correct довжині масиву answers.

У разі помилки імпорт скасовується, і відображається лог з номером проблемного питання.

### 7.5 Правила оцінювання
- Вага кожного питання — 100%.
- Якщо правильних відповідей кілька — кожна має однакову вагу (наприклад: три правильні = по 33.3% кожна).
- Якщо користувач набирає 60% або більше правильних варіантів у цьому питанні — воно зараховується як правильне.

**Приклад:**
- Правильні відповіді: [0, 1, 3]
- Обрані: [0, 1] → 66.6% → ✅ зараховано
- Обрані: [1, 2] → 33.3% → ❌ не зараховано